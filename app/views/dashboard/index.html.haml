-#--
-#   Copyright (C) 2010 Gaurav Menghani <gaurav.menghani@gmail.com>
-#
-#   This program is free software: you can redistribute it and/or modify
-#   it under the terms of the GNU Affero General Public License as published by
-#   the Free Software Foundation, either version 3 of the License, or
-#   (at your option) any later version.
-#
-#   This program is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY; without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#   GNU Affero General Public License for more details.
-#
-#   You should have received a copy of the GNU Affero General Public License
-#   along with this program.  If not, see <http://www.gnu.org/licenses/>.
-#++

= javascript_include_tag :defaults
 
.post
  %h2.title
    - if !logged_in?
      Welcome to FSoC
    - else
      =h current_user.user_type.capitalize
      Dashboard
  %p.meta
    %span.date &nbsp;
  %div{:style => 'clear: both'} &nbsp;
  .entry
        
    - if !logged_in?
      %h3 Hi and welcome to FSoC
      %p.links
        = link_to 'Login', login_path
        or 
        = link_to 'Signup', signup_path
        to get started.
    - else
      - if admin?
        %div{:id => "update_form"}
          %h3
            = link_to_remote 'Send an Update', :update => "update_form", :url => { :action => "load_update_form" }
          %br  
      - if @updates.empty?
        %h3
          Currently there are no updates for you.
      - else
        - @updates.each do |update|
          %table{:id => 'hor-minimalist-a'}
            %tr
              %th
                - if !update.user_group.nil? and !update.user_group.empty?
                  Sent to
                  = update.user_group.titleize
                - else
                  Sent to You
                .rightfloat
                  %small
                    = distance_of_time_in_words(update.created_at, Time.now, true)
                    back
            %tr
              %td
                =h update.message
                - if !update.link.nil? and !update.link.empty?  
                  %br
                  = link_to update.link_string, update.link

      
      %p.links
        - if !admin?
          = link_to 'My Projects', :controller => "dashboard", :action => "projects"
          &nbsp;|&nbsp;
          = link_to 'My Proposals', :controller => "dashboard", :action => "proposals"
          &nbsp;|&nbsp;
          = link_to 'Project Task Status', :controller => "dashboard", :action => "task_status"
        - if admin?
          = link_to 'Application Settings', :controller => "dashboard", :action => "application_settings"
          &nbsp;|&nbsp;
          - if can_configure?
            = link_to 'Configure Timeframes', :controller => "dashboard", :action => "configure"
            &nbsp;|&nbsp;
          = link_to 'Certificate Settings', :controller => "dashboard", :action => "certificates"

